<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üî• Recipe Vault</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #f5f5f5;
            min-height: 100vh;
            color: #333;
        }
        
        /* Header */
        .header {
            background: linear-gradient(135deg, #ff6b6b, #feca57);
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            color: white;
            font-size: 2rem;
            margin-bottom: 5px;
        }
        
        .header p {
            color: rgba(255,255,255,0.9);
            font-size: 0.9rem;
        }
        
        /* Search Bar */
        .search-container {
            padding: 20px;
            background: white;
            border-bottom: 1px solid #eee;
        }
        
        .search-bar {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #eee;
            border-radius: 30px;
            font-size: 1rem;
            outline: none;
            transition: border-color 0.3s;
        }
        
        .search-bar:focus {
            border-color: #ff6b6b;
        }
        
        /* Categories */
        .categories {
            display: flex;
            overflow-x: auto;
            padding: 15px;
            gap: 10px;
            background: white;
            border-bottom: 1px solid #eee;
            -webkit-overflow-scrolling: touch;
        }
        
        .category-btn {
            flex-shrink: 0;
            padding: 10px 20px;
            border: none;
            border-radius: 25px;
            background: #f0f0f0;
            color: #666;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .category-btn.active {
            background: #ff6b6b;
            color: white;
        }
        
        .category-btn:hover {
            background: #ff6b6b;
            color: white;
        }
        
        /* Main Content */
        .main-content {
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .section-title {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 15px;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-title span {
            font-size: 1.5rem;
        }
        
        /* Recipe Grid */
        .recipe-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .recipe-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
        }
        
        .recipe-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
        }
        
        .recipe-image {
            height: 180px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 4rem;
            overflow: hidden;
        }
        
        .recipe-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .recipe-content {
            padding: 15px;
        }
        
        .recipe-category {
            display: inline-block;
            padding: 4px 12px;
            background: #ffe0e0;
            color: #ff6b6b;
            border-radius: 15px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            margin-bottom: 8px;
        }
        
        .recipe-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 8px;
            line-height: 1.3;
        }
        
        .recipe-meta {
            display: flex;
            gap: 15px;
            color: #888;
            font-size: 0.85rem;
        }
        
        .recipe-meta span {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        /* Add Button */
        .fab {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #ff6b6b, #feca57);
            border: none;
            color: white;
            font-size: 2rem;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(255,107,107,0.4);
            transition: transform 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .fab:hover {
            transform: scale(1.1);
        }
        
        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #888;
        }
        
        .empty-state-icon {
            font-size: 5rem;
            margin-bottom: 20px;
        }
        
        .empty-state h3 {
            font-size: 1.3rem;
            margin-bottom: 10px;
            color: #666;
        }
        
        /* Recipe Detail Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            overflow-y: auto;
        }
        
        .modal.active {
            display: block;
        }
        
        .modal-content {
            background: white;
            max-width: 600px;
            margin: 50px auto;
            border-radius: 20px;
            overflow: hidden;
            position: relative;
        }
        
        .modal-header {
            height: 250px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 6rem;
            position: relative;
        }
        
        .modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.9);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        .modal-body {
            padding: 30px;
        }
        
        .modal-title {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 15px;
            color: #333;
        }
        
        .modal-meta {
            display: flex;
            gap: 20px;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
        }
        
        .modal-meta-item {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #666;
        }
        
        .modal-section {
            margin-bottom: 25px;
        }
        
        .modal-section h3 {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 15px;
            color: #ff6b6b;
        }
        
        .modal-section ul, .modal-section ol {
            padding-left: 20px;
            line-height: 1.8;
        }
        
        .modal-section li {
            margin-bottom: 10px;
            color: #555;
        }
        
        .video-btn {
            display: inline-block;
            background: #1877f2;
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            margin-top: 20px;
            transition: background 0.3s;
        }
        
        .video-btn:hover {
            background: #166fe5;
        }
        
        /* Loading State */
        .loading {
            text-align: center;
            padding: 40px;
            color: #888;
        }
        
        /* Status Bar */
        .status-bar {
            background: #d4edda;
            color: #155724;
            padding: 10px 20px;
            text-align: center;
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .status-bar.error {
            background: #f8d7da;
            color: #721c24;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <h1>üî• Recipe Vault</h1>
        <p>Your Personal Recipe Collection</p>
    </div>
    
    <!-- Status Bar -->
    <div id="statusBar" class="status-bar">üì° Loading recipes...</div>
    
    <!-- Search -->
    <div class="search-container">
        <input type="text" class="search-bar" placeholder="üîç Search recipes..." id="searchInput">
    </div>
    
    <!-- Categories -->
    <div class="categories">
        <button class="category-btn active" data-category="all">All</button>
        <button class="category-btn" data-category="breakfast">üç≥ Breakfast</button>
        <button class="category-btn" data-category="lunch">ü•ó Lunch</button>
        <button class="category-btn" data-category="dinner">üçΩÔ∏è Dinner</button>
        <button class="category-btn" data-category="dessert">üç∞ Dessert</button>
        <button class="category-btn" data-category="snacks">ü•® Snacks</button>
        <button class="category-btn" data-category="healthy">üí™ Healthy</button>
    </div>
    
    <!-- Main Content -->
    <div class="main-content">
        <!-- Featured Section -->
        <div id="featuredSection">
            <h2 class="section-title"><span>‚≠ê</span> Featured Recipes</h2>
            <div id="recipeGrid" class="recipe-grid">
                <div class="loading">Loading recipes...</div>
            </div>
        </div>
        
        <!-- Categories Sections -->
        <div id="breakfastSection" style="display:none;">
            <h2 class="section-title"><span>üç≥</span> Breakfast</h2>
            <div id="breakfastGrid" class="recipe-grid"></div>
        </div>
        
        <div id="lunchSection" style="display:none;">
            <h2 class="section-title"><span>ü•ó</span> Lunch</h2>
            <div id="lunchGrid" class="recipe-grid"></div>
        </div>
        
        <div id="dinnerSection" style="display:none;">
            <h2 class="section-title"><span>üçΩÔ∏è</span> Dinner</h2>
            <div id="dinnerGrid" class="recipe-grid"></div>
        </div>
        
        <div id="healthySection" style="display:none;">
            <h2 class="section-title"><span>üí™</span> High Protein</h2>
            <div id="healthyGrid" class="recipe-grid"></div>
        </div>
        
        <div id="snackSection" style="display:none;">
            <h2 class="section-title"><span>üçø</span> Snacks</h2>
            <div id="snackGrid" class="recipe-grid"></div>
        </div>
        
        <div id="dessertSection" style="display:none;">
            <h2 class="section-title"><span>üç∞</span> Desserts</h2>
            <div id="dessertGrid" class="recipe-grid"></div>
        </div>
    </div>
    
    <!-- Floating Action Button -->
    <button class="fab" onclick="openAddModal()">+</button>
    
    <!-- Recipe Detail Modal -->
    <div id="recipeModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <span id="modalEmoji">üçï</span>
                <button class="modal-close" onclick="closeModal()">√ó</button>
            </div>
            <div class="modal-body">
                <h2 id="modalTitle" class="modal-title">Recipe Title</h2>
                <div class="modal-meta">
                    <div class="modal-meta-item">
                        <span>‚è±Ô∏è</span>
                        <span id="modalTime">30 mins</span>
                    </div>
                    <div class="modal-meta-item">
                        <span>üî•</span>
                        <span id="modalCalories">450 cal</span>
                    </div>
                    <div class="modal-meta-item">
                        <span>üç≥</span>
                        <span id="modalCategory">Dinner</span>
                    </div>
                </div>
                <div class="modal-section">
                    <h3>ü•ò Ingredients</h3>
                    <ul id="modalIngredients"></ul>
                </div>
                <div class="modal-section">
                    <h3>üë®‚Äçüç≥ Instructions</h3>
                    <ol id="modalSteps"></ol>
                </div>
                <div id="videoLinkSection" style="display:none; margin-top:20px;">
                    <a id="videoLinkBtn" href="#" target="_blank" class="video-btn">üì∫ Watch Video on Facebook</a>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        const API_URL = 'https://blaze9246.github.io/recipe-vault/recipes.json?v=' + Date.now();
        let recipes = [];
        let currentCategory = 'all';
        
        // Food emojis mapping
        const foodEmojis = {
            'pizza': 'üçï',
            'burger': 'üçî',
            'salad': 'ü•ó',
            'chicken': 'üçó',
            'pasta': 'üçù',
            'breakfast': 'üç≥',
            'dessert': 'üç∞',
            'fish': 'üêü',
            'soup': 'üç≤',
            'bread': 'üçû',
            'default': 'üçΩÔ∏è'
        };
        
        function getEmoji(recipeName) {
            const name = recipeName.toLowerCase();
            for (const [key, emoji] of Object.entries(foodEmojis)) {
                if (name.includes(key)) return emoji;
            }
            return foodEmojis.default;
        }
        
        function categorizeRecipe(recipe) {
            // First check if recipe has category from JSON
            if (recipe.category) {
                const cat = recipe.category.toLowerCase();
                const sub = recipe.subcategory || '';
                
                const displayMap = {
                    'breakfast': 'Breakfast',
                    'lunch': 'Lunch',
                    'dinner': 'Dinner',
                    'snack': 'Snack',
                    'dessert': 'Dessert',
                    'side': 'Side',
                    'beverage': 'Drink'
                };
                
                return { 
                    category: cat, 
                    display: displayMap[cat] || cat.charAt(0).toUpperCase() + cat.slice(1)
                };
            }
            
            // Fallback to keyword matching only if no category in JSON
            const name = recipe.name.toLowerCase();
            const ingredients = recipe.ingredients ? recipe.ingredients.join(' ').toLowerCase() : '';
            
            if (name.includes('breakfast') || name.includes('pancake') || name.includes('oat')) {
                return { category: 'breakfast', display: 'Breakfast' };
            }
            if (name.includes('lunch') || name.includes('salad') || name.includes('sandwich')) {
                return { category: 'lunch', display: 'Lunch' };
            }
            if (name.includes('dinner') || name.includes('pasta') || name.includes('steak') || name.includes('pizza')) {
                return { category: 'dinner', display: 'Dinner' };
            }
            if (name.includes('dessert') || name.includes('cake') || name.includes('cookie') || name.includes('sweet') || name.includes('bun')) {
                return { category: 'dessert', display: 'Dessert' };
            }
            if (name.includes('snack') || name.includes('nugget') || name.includes('chip')) {
                return { category: 'snack', display: 'Snack' };
            }
            return { category: 'dinner', display: 'Dinner' };
        }
        
        async function loadRecipes() {
            try {
                const response = await fetch(API_URL);
                if (response.ok) {
                    recipes = await response.json();
                    document.getElementById('statusBar').textContent = `‚úÖ ${recipes.length} recipes loaded`;
                    renderRecipes();
                } else {
                    throw new Error('Failed to load');
                }
            } catch (error) {
                document.getElementById('statusBar').className = 'status-bar error';
                document.getElementById('statusBar').textContent = '‚ùå Using saved recipes';
                recipes = JSON.parse(localStorage.getItem('recipes') || '[]');
                renderRecipes();
            }
        }
        
        function getRecipeImage(recipe) {
            // Check for cover_image or image field
            const imagePath = recipe.cover_image || recipe.image;
            if (imagePath) {
                return `<img src="${imagePath}" alt="${recipe.name}" style="width: 100%; height: 100%; object-fit: cover; border-radius: 15px;">`;
            }
            // Fall back to emoji
            return getEmoji(recipe.name);
        }

        function renderRecipes() {
            const grid = document.getElementById('recipeGrid');
            
            if (recipes.length === 0) {
                grid.innerHTML = `
                    <div class="empty-state" style="grid-column: 1/-1;">
                        <div class="empty-state-icon">üç≥</div>
                        <h3>No recipes yet</h3>
                        <p>Add your first recipe!</p>
                    </div>
                `;
                return;
            }
            
            grid.innerHTML = recipes.map(recipe => {
                const cat = categorizeRecipe(recipe);
                const imageContent = getRecipeImage(recipe);
                return `
                    <div class="recipe-card" onclick="openRecipe('${recipe.id}')">
                        <div class="recipe-image">${imageContent}</div>
                        <div class="recipe-content">
                            <span class="recipe-category">${cat.display}</span>
                            <h3 class="recipe-title">${recipe.name}</h3>
                            <div class="recipe-meta">
                                <span>‚è±Ô∏è 30m</span>
                                <span>üî• ${recipe.calories || 'N/A'} cal</span>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
            
            // Update category sections
            updateCategorySections();
        }
        
        function updateCategorySections() {
            // Map button names to category names
            const categoryMap = {
                'breakfast': 'breakfast',
                'lunch': 'lunch',
                'dinner': 'dinner',
                'snack': 'snacks',  // category 'snack' -> section 'snacks'
                'dessert': 'dessert',
                'healthy': 'healthy'
            };
            
            Object.entries(categoryMap).forEach(([cat, sectionName]) => {
                const section = document.getElementById(sectionName + 'Section');
                const grid = document.getElementById(sectionName + 'Grid');
                
                if (!section || !grid) return; // Skip if section doesn't exist
                
                const catRecipes = recipes.filter(r => categorizeRecipe(r).category === cat);
                
                if (catRecipes.length > 0) {
                    section.style.display = 'block';
                    grid.innerHTML = catRecipes.map(recipe => {
                        const imageContent = getRecipeImage(recipe);
                        return `
                            <div class="recipe-card" onclick="openRecipe('${recipe.id}')">
                                <div class="recipe-image">${imageContent}</div>
                                <div class="recipe-content">
                                    <span class="recipe-category">${categorizeRecipe(recipe).display}</span>
                                    <h3 class="recipe-title">${recipe.name}</h3>
                                    <div class="recipe-meta">
                                        <span>‚è±Ô∏è 30m</span>
                                        <span>üî• ${recipe.calories || 'N/A'} cal</span>
                                    </div>
                                </div>
                            </div>
                        `;
                    }).join('');
                } else {
                    section.style.display = 'none';
                }
            });
        }
        
        function openRecipe(id) {
            const recipe = recipes.find(r => r.id === id);
            if (!recipe) return;
            
            document.getElementById('modalTitle').textContent = recipe.name;
            
            // Show cover image or emoji
            const modalEmoji = document.getElementById('modalEmoji');
            const imagePath = recipe.cover_image || recipe.image;
            if (imagePath) {
                modalEmoji.innerHTML = `<img src="${imagePath}" style="width: 80px; height: 80px; object-fit: cover; border-radius: 15px;">`;
            } else {
                modalEmoji.textContent = getEmoji(recipe.name);
            }
            
            document.getElementById('modalCalories').textContent = (recipe.calories || 'N/A') + ' cal';
            document.getElementById('modalCategory').textContent = categorizeRecipe(recipe).display;
            
            document.getElementById('modalIngredients').innerHTML = recipe.ingredients
                .map(ing => `<li>${ing}</li>`).join('');
            
            document.getElementById('modalSteps').innerHTML = recipe.steps
                .map(step => `<li>${step}</li>`).join('');
            
            // Show video link if available
            const videoSection = document.getElementById('videoLinkSection');
            const videoBtn = document.getElementById('videoLinkBtn');
            if (recipe.facebook_link || recipe.video_url || recipe.source_url) {
                videoSection.style.display = 'block';
                videoBtn.href = recipe.facebook_link || recipe.video_url || recipe.source_url;
            } else {
                videoSection.style.display = 'none';
            }
            
            document.getElementById('recipeModal').classList.add('active');
        }
        
        function closeModal() {
            document.getElementById('recipeModal').classList.remove('active');
        }
        
        function openAddModal() {
            alert('Add recipe: Send recipe links to Blaze via WhatsApp!');
        }
        
        // Category filtering
        document.querySelectorAll('.category-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                
                const category = this.dataset.category;
                
                // Hide all sections first
                document.getElementById('featuredSection').style.display = 'none';
                document.getElementById('breakfastSection').style.display = 'none';
                document.getElementById('lunchSection').style.display = 'none';
                document.getElementById('dinnerSection').style.display = 'none';
                document.getElementById('snackSection').style.display = 'none';
                document.getElementById('dessertSection').style.display = 'none';
                document.getElementById('healthySection').style.display = 'none';
                
                // Show selected
                if (category === 'all') {
                    document.getElementById('featuredSection').style.display = 'block';
                } else if (category === 'breakfast') {
                    document.getElementById('breakfastSection').style.display = 'block';
                } else if (category === 'lunch') {
                    document.getElementById('lunchSection').style.display = 'block';
                } else if (category === 'dinner') {
                    document.getElementById('dinnerSection').style.display = 'block';
                } else if (category === 'snacks') {
                    document.getElementById('snackSection').style.display = 'block';
                } else if (category === 'dessert') {
                    document.getElementById('dessertSection').style.display = 'block';
                } else if (category === 'healthy') {
                    document.getElementById('healthySection').style.display = 'block';
                } else {
                    document.getElementById('featuredSection').style.display = 'block';
                }
            });
        });
        
        // Close modal on outside click
        document.getElementById('recipeModal').addEventListener('click', function(e) {
            if (e.target === this) closeModal();
        });
        
        // Load recipes on start
        loadRecipes();
    </script>
</body>
</html>
